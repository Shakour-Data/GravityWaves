<nav id="sidebar" class="sidebar" aria-label="Sidebar">
    <button id="sidebar-toggle" class="sidebar-toggle" aria-expanded="true" aria-controls="sidebar" aria-label="Toggle sidebar">
        &#9776;
    </button>
    <div id="sidebar-content" class="sidebar-content">
        <div id="global-settings" class="sidebar-section">
            <h3 class="sidebar-section-title">Global Settings</h3>
            <form id="global-settings-form" class="sidebar-form" role="form" aria-label="Global Settings Form">
                <label for="global_ticker" class="sidebar-label">Ticker Symbol:</label>
                <input type="text" id="global_ticker" name="ticker" required class="sidebar-input" aria-required="true" />

                <label for="global_analysis_date" class="sidebar-label">Analysis Date:</label>
                <input type="date" id="global_analysis_date" name="analysis_date" required class="sidebar-input" aria-required="true" />

                <label for="global_timeframe" class="sidebar-label">Timeframe:</label>
                <select id="global_timeframe" name="timeframe" class="sidebar-select" aria-required="true">
                    <option value="1d" selected>Daily</option>
                    <option value="1wk">Weekly</option>
                    <option value="1mo">Monthly</option>
                </select>

                <label for="global_candle_count" class="sidebar-label">Candle Count:</label>
                <input type="number" id="global_candle_count" name="candle_count" min="1" max="1000" value="500" class="sidebar-input" aria-required="true" />

                <label for="global_investment_horizon" class="sidebar-label">Investment Horizon (days):</label>
                <input type="number" id="global_investment_horizon" name="investment_horizon" min="1" max="3650" value="10" class="sidebar-input" aria-required="true" />

                <label for="global_data_source" class="sidebar-label">Data Source:</label>
                <select id="global_data_source" name="data_source" class="sidebar-select" aria-required="true">
                    <option value="yahoo" selected>Yahoo</option>
                    <option value="tse">TSE</option>
                </select>
            </form>
        </div>
        <script src="{{ url_for('static', filename='js/global_settings.js') }}"></script>
        <script src="{{ url_for('static', filename='js/persian_date_converter.js') }}"></script>

        <script>
            document.addEventListener('DOMContentLoaded', () => {
                const breadcrumbElem = document.getElementById('breadcrumb');
                const endpoint = "{{ request.endpoint }}";
                let breadcrumbText = '';

                switch(endpoint) {
                    case 'market_status_analysis':
                        breadcrumbText = 'Market Status Analysis';
                        break;
                    case 'forecast_analysis':
                        breadcrumbText = 'Forecast Analysis';
                        break;
                    case 'indicator_analysis':
                        breadcrumbText = 'Indicator Analysis';
                        break;
                    case 'optimization_results':
                        breadcrumbText = 'Optimization Results';
                        break;
                    case 'comparative_results':
                        breadcrumbText = 'Comparative Model Results';
                        break;
                    case 'custom_analysis':
                        breadcrumbText = 'Custom Analysis';
                        break;
                    case 'trading_signals_backtesting':
                        breadcrumbText = 'Trading Signals & Backtesting';
                        break;
                    case 'about':
                        breadcrumbText = 'About Us';
                        break;
                    case 'pricing':
                        breadcrumbText = 'Pricing';
                        break;
                    case 'sitemap':
                        breadcrumbText = 'Sitemap';
                        break;
                    default:
                        breadcrumbText = '';
                }

                breadcrumbElem.textContent = breadcrumbText;
            });
        </script>

        {% if request.endpoint == 'market_status_analysis' %}
        <div id="advanced-settings" class="sidebar-section">
            <h3 class="sidebar-section-title">Advanced Settings - Market Status</h3>
            <form id="market-status-sidebar-form" class="sidebar-form">
                <label for="ms_selected_models" class="sidebar-label">Select Models (comma-separated):</label>
                <input type="text" id="ms_selected_models" name="selected_models" placeholder="RandomForestClassifier,LogisticRegression" value="RandomForestClassifier" class="sidebar-input" />

                <label for="ms_prediction_type" class="sidebar-label">Prediction Type:</label>
                <select id="ms_prediction_type" name="prediction_type" class="sidebar-select">
                    <option value="classification" selected>Classification</option>
                    <option value="regression">Regression</option>
                </select>

                <label for="ms_enable_feature_engineering" class="sidebar-label">Enable Feature Engineering:</label>
                <select id="ms_enable_feature_engineering" name="enable_feature_engineering" class="sidebar-select">
                    <option value="true" selected>True</option>
                    <option value="false">False</option>
                </select>

                <label for="ms_use_volume_features" class="sidebar-label">Use Volume Features:</label>
                <select id="ms_use_volume_features" name="use_volume_features" class="sidebar-select">
                    <option value="true" selected>True</option>
                    <option value="false">False</option>
                </select>

                <label for="ms_use_price_std_features" class="sidebar-label">Use Price Std Features:</label>
                <select id="ms_use_price_std_features" name="use_price_std_features" class="sidebar-select">
                    <option value="true" selected>True</option>
                    <option value="false">False</option>
                </select>

                <button type="submit" class="sidebar-button">Run Market Status Analysis</button>
            </form>
        </div>
        {% elif request.endpoint == 'forecast_analysis' %}
        <div id="advanced-settings" class="sidebar-section">
            <h3 class="sidebar-section-title">Advanced Settings - Forecast</h3>
            <form id="forecast-sidebar-form" class="sidebar-form">
                <label for="forecast_selected_models" class="sidebar-label">Select Models (comma-separated):</label>
                <input type="text" id="forecast_selected_models" name="selected_models" placeholder="RandomForestClassifier,LogisticRegression" value="RandomForestClassifier" class="sidebar-input" />

                <label for="forecast_prediction_type" class="sidebar-label">Prediction Type:</label>
                <select id="forecast_prediction_type" name="prediction_type" class="sidebar-select">
                    <option value="classification" selected>Classification</option>
                    <option value="regression">Regression</option>
                </select>

                <label for="forecast_prediction_horizons" class="sidebar-label">Prediction Horizons (comma-separated):</label>
                <input type="text" id="forecast_prediction_horizons" name="prediction_horizons" value="1,5,10" class="sidebar-input" />

                <button type="submit" class="sidebar-button">Run Forecast Analysis</button>
            </form>
        </div>
        {% elif request.endpoint == 'indicator_analysis' %}
        <div id="advanced-settings" class="sidebar-section">
            <h3 class="sidebar-section-title">Advanced Settings - Indicator Analysis</h3>
            <form id="indicator-analysis-sidebar-form" class="sidebar-form">
                <label class="sidebar-label">Select Indicators:</label>
                <div>
                    <input type="checkbox" id="ind_sma" name="indicators" value="SMA" />
                    <label for="ind_sma">SMA (Simple Moving Average)</label>
                </div>
                <div>
                    <label for="sma_window" class="sidebar-label">SMA Window(s) (comma-separated):</label>
                    <input type="text" id="sma_window" name="SMA_window" placeholder="e.g. 14,20,50" class="sidebar-input" />
                </div>

                <div>
                    <input type="checkbox" id="ind_ema" name="indicators" value="EMA" />
                    <label for="ind_ema">EMA (Exponential Moving Average)</label>
                </div>
                <div>
                    <label for="ema_window" class="sidebar-label">EMA Window(s) (comma-separated):</label>
                    <input type="text" id="ema_window" name="EMA_window" placeholder="e.g. 12,26" class="sidebar-input" />
                </div>

                <div>
                    <input type="checkbox" id="ind_rsi" name="indicators" value="RSI" />
                    <label for="ind_rsi">RSI (Relative Strength Index)</label>
                </div>
                <div>
                    <label for="rsi_window" class="sidebar-label">RSI Window(s) (comma-separated):</label>
                    <input type="text" id="rsi_window" name="RSI_window" placeholder="e.g. 14" class="sidebar-input" />
                </div>

                <div>
                    <input type="checkbox" id="ind_macd" name="indicators" value="MACD" />
                    <label for="ind_macd">MACD (Moving Average Convergence Divergence)</label>
                </div>
                <div>
                    <label for="macd_window_fast" class="sidebar-label" style="padding-left: 1rem;">MACD Fast Window(s) (comma-separated):</label>
                    <input type="text" id="macd_window_fast" name="MACD_window_fast" placeholder="e.g. 12" class="sidebar-input" />
                </div>
                <div>
                    <label for="macd_window_slow" class="sidebar-label" style="padding-left: 1rem;">MACD Slow Window(s) (comma-separated):</label>
                    <input type="text" id="macd_window_slow" name="MACD_window_slow" placeholder="e.g. 26" class="sidebar-input" />
                </div>
                <div>
                    <label for="macd_window_sign" class="sidebar-label" style="padding-left: 1rem;">MACD Signal Window(s) (comma-separated):</label>
                    <input type="text" id="macd_window_sign" name="MACD_window_sign" placeholder="e.g. 9" class="sidebar-input" />
                </div>

                <div>
                    <input type="checkbox" id="ind_bbands" name="indicators" value="BollingerBands" />
                    <label for="ind_bbands">Bollinger Bands</label>
                </div>
                <div>
                    <label for="bbands_window" class="sidebar-label">BBands Window(s) (comma-separated):</label>
                    <input type="text" id="bbands_window" name="BollingerBands_window" placeholder="e.g. 20" class="sidebar-input" />
                </div>
                <div>
                    <label for="bbands_window_dev" class="sidebar-label">BBands Deviation(s) (comma-separated):</label>
                    <input type="text" id="bbands_window_dev" name="BollingerBands_window_dev" placeholder="e.g. 2" class="sidebar-input" />
                </div>

                <div>
                    <input type="checkbox" id="ind_obv" name="indicators" value="OBV" />
                    <label for="ind_obv">On-Balance Volume (OBV)</label>
                </div>

                <div>
                    <input type="checkbox" id="ind_vwap" name="indicators" value="VWAP" />
                    <label for="ind_vwap">Volume Weighted Average Price (VWAP)</label>
                </div>
                <div>
                    <label for="vwap_window" class="sidebar-label">VWAP Window(s) (comma-separated):</label>
                    <input type="text" id="vwap_window" name="VWAP_window" placeholder="e.g. 14" class="sidebar-input" />
                </div>

                <div>
                    <input type="checkbox" id="ind_adx" name="indicators" value="ADX" />
                    <label for="ind_adx">Average Directional Index (ADX)</label>
                </div>
                <div>
                    <label for="adx_window" class="sidebar-label">ADX Window(s) (comma-separated):</label>
                    <input type="text" id="adx_window" name="ADX_window" placeholder="e.g. 14" class="sidebar-input" />
                </div>

                <div>
                    <input type="checkbox" id="ind_atr" name="indicators" value="AverageTrueRange" />
                    <label for="ind_atr">Average True Range (ATR)</label>
                </div>
                <div>
                    <label for="atr_window" class="sidebar-label">ATR Window(s) (comma-separated):</label>
                    <input type="text" id="atr_window" name="AverageTrueRange_window" placeholder="e.g. 14" class="sidebar-input" />
                </div>

                <div>
                    <input type="checkbox" id="ind_stoch" name="indicators" value="StochasticOscillator" />
                    <label for="ind_stoch">Stochastic Oscillator</label>
                </div>
                <div>
                    <label for="stoch_window" class="sidebar-label">Stochastic Window(s) (comma-separated):</label>
                    <input type="text" id="stoch_window" name="StochasticOscillator_window" placeholder="e.g. 14" class="sidebar-input" />
                </div>
                <div>
                    <label for="stoch_smooth_window" class="sidebar-label">Stochastic Smooth Window(s) (comma-separated):</label>
                    <input type="text" id="stoch_smooth_window" name="StochasticOscillator_smooth_window" placeholder="e.g. 3" class="sidebar-input" />
                </div>

                <div>
                    <input type="checkbox" id="ind_cci" name="indicators" value="CCI" />
                    <label for="ind_cci">Commodity Channel Index (CCI)</label>
                </div>
                <div>
                    <label for="cci_window" class="sidebar-label">CCI Window(s) (comma-separated):</label>
                    <input type="text" id="cci_window" name="CCI_window" placeholder="e.g. 14" class="sidebar-input" />
                </div>

                <div>
                    <input type="checkbox" id="ind_mfi" name="indicators" value="MFI" />
                    <label for="ind_mfi">Money Flow Index (MFI)</label>
                </div>
                <div>
                    <label for="mfi_window" class="sidebar-label">MFI Window(s) (comma-separated):</label>
                    <input type="text" id="mfi_window" name="MFI_window" placeholder="e.g. 14" class="sidebar-input" />
                </div>

                <div>
                    <input type="checkbox" id="ind_adl" name="indicators" value="AccDistIndex" />
                    <label for="ind_adl">Accumulation Distribution Line (ADL)</label>
                </div>

                <button type="submit" class="sidebar-button">Run Indicator Analysis</button>
            </form>
        </div>
        {% elif request.endpoint == 'optimization_results' %}
        <div id="advanced-settings" class="sidebar-section">
            <h3 class="sidebar-section-title">Advanced Settings - Optimization Results</h3>
            <form id="optimization-results-sidebar-form" class="sidebar-form">
                <!-- Add advanced settings inputs specific to Optimization Results here -->
                <button type="submit" class="sidebar-button">Run Optimization</button>
            </form>
        </div>
        {% elif request.endpoint == 'comparative_results' %}
        <div id="advanced-settings" class="sidebar-section">
            <h3 class="sidebar-section-title">Advanced Settings - Comparative Results</h3>
            <form id="comparative-results-sidebar-form" class="sidebar-form">
                <!-- Add advanced settings inputs specific to Comparative Results here -->
            </form>
        </div>
        {% endif %}
    </div>
</nav>
